[{"id":"d3e49ebf88f6993b40db7660670c9af3","title":"Windowså†…æ ¸","content":"01_ç¯å¢ƒæ­å»º\nWindows XP Professional è™šæ‹Ÿæœº\nå†…å­˜256MBï¼Œå°ä¸€ç‚¹æ–¹ä¾¿å¿«ç…§\nå¤„ç†å™¨å•æ ¸å•çº¿ç¨‹ï¼Œæ–¹ä¾¿å®éªŒï¼Œå¤šæ ¸å…·æœ‰å¤æ‚æ€§\nä¸²å£ \\\\.\\pipe\\com_1\nC:\\\\boot.ini è®¾ç½®è°ƒè¯•æ¨¡å¼ï¼šmulti(0)disk(0)rdisk(0)partition(1)\\WINDOWS&#x3D;â€Microsoft Windows XP Professionalâ€ &#x2F;noexecute&#x3D;optin &#x2F;fastdetect &#x2F;debug &#x2F;debugport&#x3D;com_1 &#x2F;baudrate&#x3D;115200\n\n\nwindbg å¯åŠ¨å‚æ•°ï¼š&quot;C:\\Program Files\\Windows Kits\\10\\Debuggers\\x64\\windbg.exe&quot; -b -k com:pipe,port=\\\\.\\pipe\\com_1,baud=115200,reconnect,resets=0 -y SRV\\*D:\\symbol\\*http://msdl.microsoft.com/download/symbols\nVisual Studio2010 (é«˜ç‰ˆæœ¬VSç”Ÿæˆçš„exeæ–‡ä»¶æ— æ³•åœ¨XPä¸Šè¿è¡Œ)\nReleaseï¼ŒWin32\né¡¹ç›®å±æ€§â€“é…ç½®å±æ€§â€“é“¾æ¥å™¨â€“éšæœºåŸºå€-&gt;å¦\né¡¹ç›®å±æ€§â€“é…ç½®å±æ€§â€“é“¾æ¥å™¨â€“å›ºå®šåŸºå€-&gt;æ˜¯\n\n\n\n02_ä¸­æ–­ææƒæœ¬èŠ‚è™šæ‹Ÿæœºå†…éœ€è¦å®‰è£…çš„å·¥å…·ï¼š\n\nXueTrï¼šæŸ¥çœ‹å†…æ ¸çŠ¶æ€\n\nç³»ç»Ÿä¸­é«˜äº0x80000000çš„åœ°å€æ˜¯å†…æ ¸åœ°å€ï¼Œä½äº0x80000000çš„åœ°å€æ˜¯ç”¨æˆ·åœ°å€\n#include&lt;cstdio&gt;\n#include&lt;cstdlib&gt;\n#include&lt;Windows.h&gt;\n\nDWORD g_tmp &#x3D; 0;\n\n&#x2F;&#x2F; r idtr                           è¯»ä¸­æ–­æè¿°ç¬¦è¡¨å¯„å­˜å™¨\n&#x2F;&#x2F; dq 8003f400 l40                  è¯»ä¸­æ–­æè¿°ç¬¦è¡¨\n&#x2F;&#x2F; eq 8003f500  0040ee00&#96;00081000   å†™ä¸­æ–­æè¿°ç¬¦è¡¨ï¼Œä¸¤è¾¹å³ç›®æ ‡å‡½æ•°0x00401000ï¼Œä¸­é—´å…«ä½æ˜¯æƒé™æè¿°ç­‰\n&#x2F;&#x2F; å†™å®Œä¹‹å XueTr ä¸Šè¿˜æ˜¯çœ‹ä¸åˆ°ï¼Œä½†æ˜¯ windbg èƒ½çœ‹åˆ°ï¼ŒåŸå› æ˜¯ XueTr çš„æ™ºèƒ½è¯†åˆ«è¯†åˆ«ä¸äº†0x00401000å‡½æ•°\n\n&#x2F;&#x2F; è£¸å‡½æ•°ï¼Œæ²¡æœ‰ push ebp ä¹‹ç±»çš„å‡½æ•°å¤´ï¼Œæ–¹ä¾¿å†™æ±‡ç¼–\nvoid __declspec(naked) IdtEntry() &#123;\n\t__asm &#123;\n\t\tmov eax, dword ptr ds:[0x8003f014]\n\t\tmov g_tmp, eax  &#x2F;&#x2F; è¿™é‡Œä¸è¦ç”¨printfï¼Œå°½é‡å°‘å†™ä»£ç ï¼Œprintfç»è¿‡å±‚å±‚è°ƒç”¨å¹²äº†å¾ˆå¤šäº‹ï¼Œåœ¨0ç¯ä¸­æ˜¯éå¸¸å±é™©çš„\n\t\tiretd           &#x2F;&#x2F; 32ä½ä¸æ˜¯iretï¼Œæ˜¯iretd\n\t&#125;\n&#125;\n\n&#x2F;&#x2F; äº§ç”Ÿåç§»ä¸º0x20çš„ä¸­æ–­\nvoid go() &#123;\n\t__asm int 0x20;\n&#125;\n&#x2F;&#x2F; 3ç¯ä¸­ int 0 å’Œç›´æ¥é™¤é›¶å¼‚å¸¸ä¸åŒï¼Œæ ¹æ®ä¸­æ–­æè¿°ç¬¦è¡¨å¯¹åº”çš„dplè¿›è¡Œä¸åŒçš„å¤„ç†\n\nint main() &#123;\n\tif ((DWORD)IdtEntry !&#x3D; 0x401000) &#123;\n\t\tprintf(&quot;wrong addr: %p&quot;, IdtEntry);\n\t\texit(-1);\n\t&#125;\n\tgo();\n\tprintf(&quot;%p\\n&quot;, g_tmp);\n\tsystem(&quot;pause&quot;);\n&#125;\n\næ³¨æ„ï¼šèƒ½è°ƒè¯•å†…æ ¸çš„åŸå› æ˜¯å¯åŠ¨äº†debugæ¨¡å¼ï¼Œè°ƒè¯•å™¨æ¥ç®¡äº†ç³»ç»Ÿï¼Œå¦åˆ™æ˜¯æ— æ³•è°ƒè¯•å†…æ ¸çš„\n03_å¤šæ ¸å¤æ‚æ€§(1)æœ¬èŠ‚è™šæ‹Ÿæœºå†…éœ€è¦å®‰è£…çš„å·¥å…·ï¼š\n\nCheat Engine 6.xï¼šæ‹¥æœ‰é©±åŠ¨æ¨¡å—dbk32.sysï¼Œå¯ä»¥æ›´æ”¹å†…æ ¸åœ°å€ã€‚ç¬¬ä¸€æ¬¡å¯åŠ¨éœ€è¦åœ¨ è®¾ç½®â€“å…¶ä»– å…¨éƒ¨å‹¾ä¸Š\n\næ³¨æ„ï¼šä¹±æ”¹å†…æ ¸åœ°å€ä¼šè“å±\n#include&lt;cstdio&gt;\n#include&lt;cstdlib&gt;\n#include&lt;Windows.h&gt;\n\nDWORD g_tmp;\n\nvoid __declspec(naked) IdtEntry() &#123;\n\t__asm &#123; &#x2F;&#x2F; ä¸­æ–­å¤„ç†è¿›ç¨‹è¿›æ¥åä¸­æ–­æ˜¯å…³é—­çŠ¶æ€ï¼Œé˜²æ­¢ä¸­æ–­åµŒå¥—\n        pushfd\n\t\tpop eax\n\t\tmov g_tmp, eax\n        &#x2F;&#x2F; ç¬¬ä¹ä½eflagæ˜¯ä¸­æ–­ä½\n\t\tiretd\n\t&#125;\n&#125;\n\nvoid go() &#123;\n\t__asm int 0x20;\n&#125;\n\nint main() &#123;\n\tif ((DWORD)IdtEntry !&#x3D; 0x401000) &#123;\n\t\tprintf(&quot;wrong addr: %p&quot;, IdtEntry);\n\t\texit(-1);\n\t&#125;\n\tgo();\n\tprintf(&quot;%p\\n&quot;, g_tmp);\n    &#x2F;&#x2F; æ˜¾ç¤º46ï¼Œæ­£å¸¸3ç¯ä¼šæ˜¯246\n\tsystem(&quot;pause&quot;);\n&#125;\n\nå¤šæ ¸æ—¶windbgåˆ‡æ¢æ ¸ï¼š\n0: kd&gt; ~1\n1: kd&gt;\n\n\n\n04_å¤šæ ¸å¤æ‚æ€§(2)#include&lt;cstdio&gt;\n#include&lt;cstdlib&gt;\n#include&lt;Windows.h&gt;\n\nvoid __declspec(naked) IdtEntry() &#123;\n\t__asm &#123;\n        &#x2F;&#x2F; å¤šæ ¸å¤æ‚æ€§ï¼šæƒ³ç¨³å®šæŒ‚é’©ï¼Œæ¶‰åŠåˆ°locké¡µï¼Œæ­¤å¤„æ˜¯ç®€å•ç»•è¿‡\n        mov eax, cr0         &#x2F;&#x2F; ä¿®æ”¹cr0ç»•è¿‡å†™ä¿æŠ¤ï¼Œcr0ä¸èƒ½ç›´æ¥ä¸\n        and eax, not 10000h  &#x2F;&#x2F; å–åï¼ŒåŒæ—¶é€‚ç”¨äºä¸åŒä½æ•°çš„å¯„å­˜å™¨\n        mov cr0, eax\n        \n        mov eax, 0xffffffff\n        &#x2F;&#x2F; 0x80542520æ¥æºäºä¸»è¦ç³»ç»Ÿæ¨¡å—ntkrpamp(ntkrnlpa.exe?)çš„_KiFastCallEntry(3ç¯è¿›0ç¯çš„å…¥å£)\n        &#x2F;&#x2F; ç”¨idaåˆ†æntkrpamp(ntkrnlpa.exe?)æ—¶éœ€è¦åŸºå€é‡å®šä½\n        mov ds:[0x80542520], eax\n        &#x2F;&#x2F; è¿™é‡Œæœ‰ä¸ªæœ‰æ„æ€çš„ç‚¹ï¼šå¯ä»¥ä¿®æ”¹idtè¡¨é¡¹ï¼Œå°†ä¹‹å‰çš„å…¥å£å‡½æ•°åœ°å€ç—•è¿¹æ¸…é™¤\n        \n\t\tiretd\n\t&#125;\n&#125;\n\nvoid go() &#123;\n\t__asm int 0x20;\n&#125;\n\nint main() &#123;\n\tif ((DWORD)IdtEntry !&#x3D; 0x401000) &#123;\n\t\tprintf(&quot;wrong addr: %p&quot;, IdtEntry);\n\t\texit(-1);\n\t&#125;\n\tgo();\n\tsystem(&quot;pause&quot;);\n&#125;\n\n\n\n05_ä¸­æ–­ç°åœº(1)è§‚å¯Ÿä¸­æ–­å‰å’Œä¸­æ–­åå¯„å­˜å™¨çš„å˜åŒ–\næ³¨æ„ï¼šä¸è¦ç”¨printfæ¥è§‚å¯Ÿï¼Œè€Œæ˜¯å¦‚åŒä¸‹é¢ä½¿ç”¨å…¨å±€å˜é‡å’ŒmovæŒ‡ä»¤è¿›è¡Œè§‚å¯Ÿï¼Œprintfä¼šç ´åå¯„å­˜å™¨ç°åœº\n#include&lt;cstdio&gt;\n#include&lt;cstdlib&gt;\n#include&lt;Windows.h&gt;\n\nDWORD g_esp[2];\n\nvoid __declspec(naked) IdtEntry() &#123;\n\t__asm &#123;\n        mov [g_esp+4], esp\n\t\tiretd\n\t&#125;\n&#125;\n\nvoid go() &#123;\n    __asm&#123;\n        mov [g_esp], esp\n    &#125;\n\t__asm int 0x20;\n&#125;\n\nint main() &#123;\n\tif ((DWORD)IdtEntry !&#x3D; 0x401000) &#123;\n\t\tprintf(&quot;wrong addr: %p&quot;, IdtEntry);\n\t\texit(-1);\n\t&#125;\n\tgo();\n    printf(&quot;%p\\n&quot;, g_esp[0]);\n    printf(&quot;%p\\n&quot;, g_esp[1]);\n\tsystem(&quot;pause&quot;);\n&#125;\n\neax,ebx,ecx,edx,esp,ebp,esi,edi,cs,ds,ss,es,fs,gs\næœ‰æ”¹å˜çš„å¯„å­˜å™¨ï¼šcs(æ ¹æ®é—¨æè¿°ç¬¦å˜åŒ–)ï¼Œssï¼Œespï¼Œeflagsï¼Œeip\næè¿°ç¬¦(ç”¨é€”ï¼šâ‘ å†…å­˜åŒºåŸŸï¼›â‘¡é—¨) gdt idt ä¿æŠ¤æ¨¡å¼ é€‰æ‹©å­\n06_ä¸­æ–­ç°åœº(2)è¿›å…¥0ç¯ä¸­æ–­å‡½æ•°åç”¨windbgæ–­ä¸‹æ¥åœ¨windbgå¯„å­˜å™¨çª—å£æŸ¥çœ‹fsçš„å€¼ä¸º30ï¼Œè€Œæ ¹æ®ä¸ŠèŠ‚çš„æƒ…å†µè§‚å¯Ÿåˆ°fsçš„å€¼æ˜¯3B(æ­¤å€¼æ˜¯æ­£ç¡®çš„)ï¼Œå› ä¸ºæ–­ç‚¹å°†ä¿¡æ¯ä¼ è¾“ç»™è°ƒè¯•å™¨æ—¶è¿›è¡Œäº†å¤§é‡ä¸å¯æ§çš„æ“ä½œã€‚â€œå¯¹å¾®è§‚ä¸–ç•Œçš„è§‚æµ‹ä¼šå¯¹å¾®è§‚ç‰©è´¨äº§ç”Ÿå½±å“â€ï¼Œè°ƒè¯•å™¨ä¾µå…¥å†…æ ¸ä¼šå¯¹å…¶äº§ç”Ÿå½±å“ã€‚æ‰€ä»¥ä¸è¦å¤ªä¾èµ–è°ƒè¯•å™¨\nä¸€ä¸ªåŸºæœ¬è§‚ç‚¹ï¼šè°ƒè¯•å™¨çš„æ ¸å¿ƒä»£ç æ˜¯ä¸èƒ½è¢«è¿›è¡Œè°ƒè¯•çš„ã€‚\n#include&lt;cstdio&gt;\n#include&lt;cstdlib&gt;\n#include&lt;Windows.h&gt;\n\nDWORD g_8003f038;   &#x2F;&#x2F; æ­¤gdtè¡¨é¡¹åœ¨windbgå’ŒXueTrä¸­æŸ¥çœ‹åˆ°çš„å€¼ä¸åŒ(XueTræ˜¯æ­£ç¡®çš„)\n\nvoid __declspec(naked) IdtEntry() &#123;\n\t__asm &#123;\n        push eax\n        mov eax, ds:[0x8003f038]\n        mov g_8003f038, eax\n        pop eax\n\t\tiretd\n\t&#125;\n&#125;\n\nvoid go() &#123;\n\t__asm int 0x20;\n&#125;\n\nint main() &#123;\n\tif ((DWORD)IdtEntry !&#x3D; 0x401000) &#123;\n\t\tprintf(&quot;wrong addr: %p&quot;, IdtEntry);\n\t\texit(-1);\n\t&#125;\n\tgo();\n    printf(&quot;%p\\n&quot;, g_8003f038);\n\tsystem(&quot;pause&quot;);\n&#125;\n\nssæ˜¯espä½¿ç”¨çš„æ®µï¼Œå½“æƒé™åˆ‡æ¢çš„æ—¶å€™ä¼´éšç€å †æ ˆçš„åˆ‡æ¢\n07_ä¸­æ–­ç°åœº(3)cpuè¿›è¡Œçº¿ç¨‹è°ƒåº¦çš„æ—¶å€™ï¼Œå°±æŠŠespå†…æ ¸æ ˆåœ°å€å’Œssåœ°å€å†™å…¥tss\nä»0ç¯å›3ç¯æ—¶æ ˆé‡Œä¾æ¬¡å­˜å‚¨äº†eipï¼Œring3 csï¼Œring3 eflagsï¼Œring3 espï¼Œring3 ssçš„å€¼\n08_å†æ¬¡å¼€ä¸­æ–­","slug":"20230915-Windows-Kernel","date":"2023-09-15T02:00:00.000Z","categories_index":"Learn","tags_index":"windows,kernel","author_index":"y9nhjy"},{"id":"f4299006905b671658e489a5612f0ab4","title":"Proxifieræ³¨å†Œæœº","content":"Declarationæœ¬é¡¹ç›®ä»…ç”¨ä½œå­¦ä¹ æ•™è‚²ç›®çš„, ä¸ç”¨äºä»»ä½•å…¶ä»–ç”¨é€”, å¦‚æœ‰ä¾µæƒè¯·ç¬¬ä¸€æ—¶é—´è”ç³»ä½œè€…åˆ é™¤\nThis project is only for learning and educational purposes and is not intended for any other purpose. If there is any infringement, please contact the author immediately to delete it\nå®‰è£…è½¯ä»¶å®˜ç½‘Proxifier - The Most Advanced Proxy Client\nè¿™é‡Œä¸‹è½½çš„æ˜¯å®‰è£…ç‰ˆ(setup)\n\nä¸€è·¯nextä¸‹å»å®‰è£…å®Œæ¯•å³å¯\næ­£å‘å¼€å§‹å¯åŠ¨Proxifierç‚¹å‡»Registration Key\n\néšä¾¿è¾“å…¥ä¼šæç¤ºKeyæ ¼å¼ä¸å¯¹, ä¸ºxxxxx-xxxxx-xxxxx-xxxxx-xxxxx, ä¸ºæ–¹ä¾¿æè¿°, æœ¬æ–‡å°†æ¯5ä¸ªå­—ç¬¦ç§°ä¸º1ç»„, ä¸‹æ–‡ä¹Ÿä¼šæåˆ°ã€‚ç„¶åç…§ç€æ ¼å¼å†æ¬¡éšä¾¿è¾“å…¥æŸ¥çœ‹Keyé”™è¯¯æ—¶çš„åé¦ˆ\n\næ¥ä¸‹æ¥, IDA, å¯åŠ¨ï¼æœç´¢å­—ç¬¦ä¸²The registration Key is incorrect.\n\nå®šä½è‡³æ­¤å¤„\n\né€šè¿‡äº¤å‰å¼•ç”¨å®šä½å…³é”®Checkå‡½æ•°\n\nCheckç®—æ³•char __fastcall Check(unsigned int *a1, _QWORD *a2, __int64 a3)\n&#123;\n  _QWORD *v4; &#x2F;&#x2F; rsi\n  const wchar_t *v6; &#x2F;&#x2F; rdx\n  _QWORD *v8; &#x2F;&#x2F; r8\n  _QWORD *v9; &#x2F;&#x2F; r8\n  _QWORD *v10; &#x2F;&#x2F; r8\n  _QWORD *v11; &#x2F;&#x2F; r8\n  _QWORD *v12; &#x2F;&#x2F; rax\n  __int16 v13; &#x2F;&#x2F; dx\n  _QWORD *v14; &#x2F;&#x2F; rax\n  __int64 v15; &#x2F;&#x2F; rax\n  __int64 v16; &#x2F;&#x2F; rcx\n  int v17; &#x2F;&#x2F; edi\n  int v18; &#x2F;&#x2F; ebx\n  __int64 v19; &#x2F;&#x2F; rax\n  __int64 v20; &#x2F;&#x2F; rcx\n  __int64 v21; &#x2F;&#x2F; rax\n  __int64 v22; &#x2F;&#x2F; rcx\n  int v23; &#x2F;&#x2F; er15\n  __int64 v24; &#x2F;&#x2F; rax\n  unsigned int v25; &#x2F;&#x2F; er15\n  __int64 v26; &#x2F;&#x2F; rcx\n  int v27; &#x2F;&#x2F; eax\n  unsigned int v28; &#x2F;&#x2F; er10\n  unsigned int v29; &#x2F;&#x2F; ecx\n  char v30[32]; &#x2F;&#x2F; [rsp+20h] [rbp-78h] BYREF\n  __int64 v31; &#x2F;&#x2F; [rsp+40h] [rbp-58h]\n  _QWORD *v32; &#x2F;&#x2F; [rsp+48h] [rbp-50h]\n  int v33[4]; &#x2F;&#x2F; [rsp+50h] [rbp-48h] BYREF\n\n  v31 &#x3D; -2i64;\n  v4 &#x3D; a2;\n  v32 &#x3D; a2;\n  if ( a2[2] !&#x3D; 29i64 )\n  &#123;\n    v6 &#x3D; L&quot;Incorrect Key length.&quot;;\nLABEL_3:\n    sub_140003550(a3, v6);\n    unknown_libname_3(v4);\n    return 0;\n  &#125;\n  v8 &#x3D; a2;\n  if ( a2[3] &gt;&#x3D; 8ui64 )\n    v8 &#x3D; (_QWORD *)*a2;\n  sub_1400034B0(a2, v33, (char *)v8 + 46);   &#x2F;&#x2F; å‡½æ•°ä½œç”¨:å»æ‰&#39;-&#39;\n  v9 &#x3D; v4;\n  if ( v4[3] &gt;&#x3D; 8ui64 )\n    v9 &#x3D; (_QWORD *)*v4;\n  sub_1400034B0(v4, v33, (char *)v9 + 34);\n  v10 &#x3D; v4;\n  if ( v4[3] &gt;&#x3D; 8ui64 )\n    v10 &#x3D; (_QWORD *)*v4;\n  sub_1400034B0(v4, v33, (char *)v10 + 22);\n  v11 &#x3D; v4;\n  if ( v4[3] &gt;&#x3D; 8ui64 )\n    v11 &#x3D; (_QWORD *)*v4;\n  sub_1400034B0(v4, v33, (char *)v11 + 10);   &#x2F;&#x2F; æœ€ç»ˆå¾—åˆ°&#39;XXXXXXXXXXXXXXXXXXXXXXXXX&#39;\n  v12 &#x3D; v4;\n  if ( v4[3] &gt;&#x3D; 8ui64 )\n    v12 &#x3D; (_QWORD *)*v4;\n  v13 &#x3D; *((_WORD *)v12 + 14);                 &#x2F;&#x2F; å–ç¬¬3ç»„ç¬¬5ä¸ªå­—ç¬¦ &#39;4&#39;\n  v14 &#x3D; v4;\n  if ( v4[3] &gt;&#x3D; 8ui64 )\n    v14 &#x3D; (_QWORD *)*v4;\n  *((_WORD *)v14 + 2) &#x3D; v13;                  &#x2F;&#x2F; ç¬¬1ç»„ç¬¬3ä¸ªå­—ç¬¦èµ‹å€¼ä¸ºç¬¬3ç»„ç¬¬5ä¸ªå­—ç¬¦, å³æ­¤å­—ç¬¦ä¸å½±å“Key\n  v15 &#x3D; sub_1400037E0(v4, v30, 20i64);        &#x2F;&#x2F; å–ç¬¬5ç»„å­—ç¬¦\n  v17 &#x3D; sub_1400031A0(v16, v15);              &#x2F;&#x2F; ç¬¬ä¸€ä¸ªå‚æ•°:v15ä¸€ä¸ªå­—ç¬¦çš„asciiå€¼\n                                              &#x2F;&#x2F; æ­¤å‡½æ•°çš„ä½œç”¨:å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—, æœ¬å‡½æ•°å¯é€†\n  v18 &#x3D; v17 ^ (v17 &lt;&lt; 7);\n  v19 &#x3D; sub_1400037E0(v4, v30, 15i64);        &#x2F;&#x2F; å–ç¬¬4ç»„å­—ç¬¦\n  a1[7] &#x3D; sub_1400031A0(v20, v19);\n  v21 &#x3D; sub_1400037E0(v4, v30, 0i64);         &#x2F;&#x2F; å–æ•´ä¸ªKeyçš„å‰7ä¸ªå­—ç¬¦\n  v23 &#x3D; sub_1400031A0(v22, v21);\n  v24 &#x3D; sub_1400037E0(v4, v30, 7i64);         &#x2F;&#x2F; å–æ•´ä¸ªKeyçš„ç¬¬8-14ä¸ªå­—ç¬¦\n  v25 &#x3D; v18 ^ v23 ^ 0x12345678;               &#x2F;&#x2F; v33çš„ä½4å­—èŠ‚\n  v27 &#x3D; sub_1400031A0(v26, v24);\n  v33[0] &#x3D; v25;\n  v33[1] &#x3D; v18 ^ v27 ^ 0x87654321;            &#x2F;&#x2F; v33çš„ä¸­4å­—èŠ‚\n  v33[2] &#x3D; a1[7];                             &#x2F;&#x2F; v33çš„é«˜4å­—èŠ‚\n  if ( v17 !&#x3D; (sub_140003260(v33) &amp; 0x1FFFFFF) )  &#x2F;&#x2F; æ­¤å‡½æ•°ç±»ä¼¼CRC32, ç›®æµ‹ä¸å¯é€†\n  &#123;\n    v6 &#x3D; L&quot;Incorrect Key&quot;;\n    goto LABEL_3;\n  &#125;\n  *a1 &#x3D; v25 &gt;&gt; 21;\n  a1[1] &#x3D; HIWORD(v25) &amp; 0x1F;\n  a1[2] &#x3D; (unsigned __int16)v25 &gt;&gt; 5;\n  a1[3] &#x3D; v25 &amp; 0x1F;\n  v29 &#x3D; HIWORD(v28);\n  a1[6] &#x3D; (unsigned __int16)v28;\n  if ( HIWORD(v28) )\n  &#123;\n    a1[4] &#x3D; v29 &#x2F; 0xC + 2000;\n    a1[5] &#x3D; v29 % 0xC;\n  &#125;\n  else\n  &#123;\n    *((_QWORD *)a1 + 2) &#x3D; 0i64;\n  &#125;\n  unknown_libname_3(v4);\n  return 1;\n&#125;\n\nå‰é¢ä¼šæ£€æŸ¥Keyçš„é•¿åº¦æ˜¯å¦ä¸º29, å³XXXXX-XXXXX-XXXXX-XXXXX-XXXXXçš„é•¿åº¦\nç„¶åä¸»è¦éœ€è¦åˆ†æsub_1400034B0, sub_1400037E0, sub_1400031A0, sub_140003260è¿™4ä¸ªå‡½æ•°çš„åŠŸèƒ½\n\næœ¬åœ°è°ƒè¯•ç›´æ¥æ­¥è¿‡çœ‹Keyçš„å˜åŒ–, å¾ˆå®¹æ˜“å°±èƒ½çœ‹å‡ºsub_1400034B0çš„åŠŸèƒ½, å³å»æ‰ â€˜-â€˜\n\nsub_1400037E0, åŒæ ·çš„åŠæ³•å¯ä»¥çœ‹å‡ºæ­¤å‡½æ•°æ˜¯å–å‡ºKeyçš„éƒ¨åˆ†å­—ç¬¦\n\nç„¶åå°±æ˜¯sub_1400031A0, è¿›å»çœ‹çœ‹\n  __int64 __fastcall sub_1400031A0(__int64 a1, __int64 a2)\n&#123;\n  unsigned int v2; &#x2F;&#x2F; ebx\n  int v3; &#x2F;&#x2F; eax\n  __int64 i; &#x2F;&#x2F; r8\n  __int64 v5; &#x2F;&#x2F; rax\n  unsigned __int16 v6; &#x2F;&#x2F; ax\n\n  v2 &#x3D; 0;\n  v3 &#x3D; *(_DWORD *)(a2 + 16) - 1;\n  for ( i &#x3D; v3; i &gt;&#x3D; 0; --i )\n  &#123;\n    v2 *&#x3D; 32;\n    v5 &#x3D; a2;\n    if ( *(_QWORD *)(a2 + 24) &gt;&#x3D; 8ui64 )\n      v5 &#x3D; *(_QWORD *)a2;\n    v6 &#x3D; *(_WORD *)(v5 + 2 * i);\n    switch ( v6 )\n    &#123;\n      case &#39;W&#39;:\n        continue;\n      case &#39;X&#39;:\n        v6 &#x3D; 79;\n        break;\n      case &#39;Y&#39;:\n        v2 &#x3D; v2 - 48 + 49;\n        continue;\n      case &#39;Z&#39;:\n        v6 &#x3D; 73;\n        break;\n      default:\n        if ( (unsigned __int16)(v6 - 48) &lt;&#x3D; 9u )\n        &#123;\n          v2 &#x3D; v6 + v2 - 48;\n          continue;\n        &#125;\n        break;\n    &#125;\n    v2 &#x3D; v6 + v2 - 55;\n  &#125;\n  unknown_libname_3(a2);\n  return v2;\n&#125;\n\n  å¯ä»¥è‡ªå·±è·Ÿç€å†™ä¸€éæ­¤ç®—æ³•, ä¸»è¦ä½œç”¨ï¼šå°†å­—ç¬¦ä¸²æ ¹æ®æ­¤ç®—æ³•è½¬æ¢ä¸ºæ•°å­—å¹¶è¿”å›, æ­¤å‡½æ•°çš„pythonå®ç°å¯ä»¥å‚è€ƒæœ¬äººy9nhjy&#x2F;Proxifier_Keygen é¡¹ç›®ä¸­Proxifier_Checker.pyé‡Œçš„handleå‡½æ•°\n\nsub_140003260ï¼šç®—æ³•ç±»ä¼¼CRC32, ç›®æµ‹ä¸å¯é€†\n\n\næœ€åæ€»ç»“Checkå®Œæ•´é€»è¾‘ï¼š\n\nå»é™¤ â€˜-â€˜\nå°†ç¬¬1ç»„ç¬¬3ä¸ªå­—ç¬¦èµ‹å€¼ä¸ºç¬¬3ç»„ç¬¬5ä¸ªå­—ç¬¦\nv17ï¼šç¬¬5ç»„å­—ç¬¦ç»è¿‡handleå‡½æ•°æ‰€ç”Ÿæˆçš„æ•°å­—\nv18 &#x3D; v17 ^ (v17 &lt;&lt; 7)\nv23ï¼šå–æ•´ä¸ªKeyçš„å‰7ä¸ªå­—ç¬¦ç»è¿‡handleå‡½æ•°æ‰€ç”Ÿæˆçš„æ•°å­—\nv27ï¼šå–æ•´ä¸ªKeyçš„ç¬¬8-14ä¸ªå­—ç¬¦ç»è¿‡handleå‡½æ•°æ‰€ç”Ÿæˆçš„æ•°å­—\nv33çš„ä½4å­—èŠ‚ï¼šv18 ^ v23 ^ 0x12345678\nv33çš„ä¸­4å­—èŠ‚ï¼šv18 ^ v27 ^ 0x87654321\nv33çš„é«˜4å­—èŠ‚ï¼šç¬¬4ç»„å­—ç¬¦ç»è¿‡handleå‡½æ•°æ‰€ç”Ÿæˆçš„æ•°å­—\næœ€åæ¯”è¾ƒ v17 !&#x3D; (sub_140003260(v33) &amp; 0x1FFFFFF)\n\né€†å‘é¡¹ç›®æºä»£ç ï¼šy9nhjy&#x2F;Proxifier_Keygen , æ¬¢è¿star\næ—¢ç„¶sub_140003260ä¸å¯é€†, å°±è€ƒè™‘æ„é€ v33\nç›®å‰å·²çŸ¥v33, é€†æ¨Keyçš„æµç¨‹ï¼š\n\næ ¹æ®é«˜4å­—èŠ‚é€†æ¨ç¬¬4ç»„å­—ç¬¦\næ ¹æ®v17 &#x3D; (sub_140003260(v33) &amp; 0x1FFFFFF)å¾—åˆ°v17åå¯é€†æ¨ç¬¬5ç»„å­—ç¬¦å’Œå¾—åˆ°v18\nv23 &#x3D; v33çš„ä½4å­—èŠ‚ ^ v18 ^ 0x12345678, ç„¶åé€†æ¨å‡ºKeyçš„å‰7ä¸ªå­—ç¬¦\nv27 &#x3D; v33çš„ä¸­4å­—èŠ‚ ^ v18 ^ 0x87654321, ç„¶åé€†æ¨å‡ºKeyçš„ç¬¬8-14ä¸ªå­—ç¬¦\nKeyçš„ç¬¬15ä¸ªå­—ç¬¦å³Keyçš„ç¬¬3ä¸ªå­—ç¬¦\néšæœºç”ŸæˆKeyçš„ç¬¬3ä¸ªå­—ç¬¦\nå¾—åˆ°æœ€ç»ˆçš„Key\n\næ³¨æ„äº‹é¡¹ï¼š\n\nv33çš„1~2å­—èŠ‚å°äº0x2580æ˜¯è¿‡æœŸçš„Key, é«˜ä¸¤å­—èŠ‚æ˜¯äº§å“ç‰ˆæœ¬, ä¸º0åˆ™æ˜¯å®‰è£…ç‰ˆ, 1æ˜¯ä¾¿æºç‰ˆ, 2æ˜¯Macç‰ˆ\nv33çš„7~8å­—èŠ‚æ˜¯è¯ä¹¦æœ‰æ•ˆæœŸ, ä¸ºé›¶ç›´æ¥æ— é™æœŸ\nKeyçš„ç¬¬3ä½ä¸å½±å“Key, ä½†æ˜¯ä¸èƒ½ä¸º â€˜Yâ€™, å¦åˆ™ç‰ˆæœ¬å¯¹ä¸ä¸Š\n\nç¢ç¢å¿µæ–­æ–­ç»­ç»­è°ƒäº†å‡ å¤©, å°†Checkç®—æ³•è¿˜åŸæˆåŠŸå, å‚è€ƒäº†Danz17&#x2F;Proxifier-Keygenæ³¨å†Œæœºçš„æºä»£ç , å­¦åˆ°äº†ä¸å°‘, å¯¹å…¶ä¸­çš„æµç¨‹ä¹Ÿæ›´åŠ æ¸…æ™°, æœ€ç»ˆæ€»ç®—æ˜¯å®ç°äº†æ³¨å†Œæœºçš„ç¼–å†™, æ¬¢è¿å„ä½å¸ˆå‚…ç»™æˆ‘çš„é¡¹ç›®star, ä¼ é€é—¨ï¼šy9nhjy&#x2F;Proxifier_Keygen \næ—¶éš”æ»¡æ»¡ä¸€å¹´ç»ˆäºæ›´æ–°äº†, ä¹‹å‰ç”µè„‘å‡ºé—®é¢˜ç³»ç»Ÿé‡è£…æ•°æ®å…¨æ²¡äº†, åŒ…æ‹¬åšå®¢, è¡€å‹æ‹‰æ»¡, å°±ä¸€ç›´æ²¡å†æŠ˜è…¾åšå®¢, è¿™æ¬¡é‡æ–°æ­å»ºåšå®¢, æ›´æ¢äº†ä¸€ä¸ªæ›´é…·ç‚«çš„ä¸»é¢˜, æ•´ä½“è¿˜æ˜¯æ¯”è¾ƒæ»¡æ„, å°±è¿™æ ·å§ã€‚\n","slug":"20230816-Proxifier-Keygen","date":"2023-08-16T03:00:00.000Z","categories_index":"Keygen","tags_index":"reverse,keygen","author_index":"y9nhjy"},{"id":"63c1d1c611bd361be9cbbdc1ef690d2f","title":"2022-HWSå¤ä»¤è¥çº¿ä¸‹èµ›","content":"2022-HWSå¤ä»¤è¥çº¿ä¸‹èµ›\næ¯”èµ›ï¼šHWSè®¡åˆ’ç¬¬äº”æœŸ-2022ç¡¬ä»¶å®‰å…¨åœ¨çº¿å¤ä»¤è¥çº¿ä¸‹èµ›\næ—¶é—´ï¼š2022-08-15 17:00:00~2022-08-01 22:00:00\nâ€œæœ‰è¶£â€çš„è’™å“¥é©¬åˆ©\nè·³åŠ¨çš„AES\nâ€œæœ‰è¶£â€çš„è’™å“¥é©¬åˆ©é‡‡é›†æ³¢å½¢\nä½é€šæ»¤æ³¢é˜ˆå€¼99\næ ¹æ®hint æ¯ä¸ªå¾ªç¯ä¼šåšä¸€æ¬¡ä¹˜è¿ç®—å’Œæ¨¡è¿ç®— æ‰€ä»¥éœ€è¦å°†ä¸¤ç«¯æ³¢åˆ†ä¸ºä¸€ç»„å¾ªç¯\næ ¹æ®ä¸æ–­è¯•é”™ å‘ç°æ¯ç»„å¾ªç¯å¦‚æˆ‘æ ‡çš„ä½ç½®æ³¢å½¢è¡¨ç¤ºäº†ä¹˜è¿ç®—çš„ä¸åŒ\nä¸€ä½ä¸€é«˜ä¸ºç¨‹åºä¸­e[i] &#x3D;&#x3D; 1çš„æƒ…å†µ\nå¦‚ä¸‹\n\n\n\n\nBECD\nè·³åŠ¨çš„AESä½é€šæ»¤æ³¢ + é™æ€å¯¹é½ + çºµå‘å¯¹é½ + 1é˜¶cpaåˆ†æå¯†é’¥ * 16times\n","slug":"20220815-hws-live","date":"2022-08-15T03:00:00.000Z","categories_index":"Write Up","tags_index":"ctf,wp,reverse","author_index":"y9nhjy"},{"id":"5bb046c422c129abba05bb14d8709ec6","title":"2022-HWS&å¼ºç½‘æ¯-å¤ç°","content":"2022-HWS&amp;å¼ºç½‘æ¯-å¤ç°\nHWS\nâ€‹\tre2\nâ€‹\tre3\nå¼ºç½‘æ¯\nâ€‹\tGameMaster\nâ€‹\teasyre\nHWSre2æ‹¿åˆ°æºæ–‡ä»¶re2.exeï¼Œæ”¾è¿›ida32é‡Œï¼Œåç¼–è¯‘ä¸»å‡½æ•°\nint __cdecl main(int argc, const char **argv, const char **envp)\n&#123;\n  char v3; &#x2F;&#x2F; bl\n  char v4; &#x2F;&#x2F; al\n  int v5; &#x2F;&#x2F; ecx\n  struct _EXCEPTION_REGISTRATION_RECORD *v7; &#x2F;&#x2F; [esp+0h] [ebp-18h]\n  void *v8; &#x2F;&#x2F; [esp+4h] [ebp-14h]\n\n  v8 &#x3D; &amp;loc_401450;\n  v7 &#x3D; NtCurrentTeb()-&gt;NtTib.ExceptionList;\n  v3 &#x3D; 0;\n  do\n  &#123;\n    v4 &#x3D; sub_40491D(v7, v8);\n    v5 &#x3D; v3++;\n    byte_41B2EC[v5] &#x3D; v4;\n  &#125;\n  while ( v4 !&#x3D; 10 );\n  byte_41B2EC[v3] &#x3D; 0;\n  dword_41B2E8 &#x3D; (char)(v3 - 1);\n  __debugbreak();\n  __debugbreak();\n  __debugbreak();\n  return 0;\n&#125;\n\næš‚æ—¶çœ‹ä¸å‡ºæ¥ä»€ä¹ˆï¼Œæƒ¯ä¾‹æ‰“å¼€å­—ç¬¦ä¸²çª—å£æŸ¥ä¸€æŸ¥\nå‘ç°ä¸¤æ¡å¯ç–‘çš„å­—ç¬¦ä¸²\n\n\nè¿™ä¸¤æ¡å­—ç¬¦ä¸²éƒ½æŒ‡å‘åŒä¸€ä¸ªå‡½æ•°\nintptr_t sub_4013D0()\n&#123;\n  int i; &#x2F;&#x2F; [esp+Ch] [ebp-4h]\n\n  for ( i &#x3D; 0; byte_41B2EC[i] &amp;&amp; i &lt;&#x3D; 8; ++i )\n  &#123;\n    if ( (i ^ byte_41B2EC[i]) !&#x3D; byte_41A8B4[i] )\n      goto LABEL_7;\n  &#125;\n  sub_401010((int)off_41A8B0);\n  _loaddll(0);\nLABEL_7:\n  sub_401010((int)&quot;wrong\\n&quot;);\n  return _loaddll(0);\n&#125;\n\næ¥ä¸‹æ¥å°±å¾ˆç®€å•äº†ï¼Œæ ¹æ®é€»è¾‘å†™exp\na &#x3D; [0x46, 0x40, 0x49, 0x46, 0x7F, 0x52, 0x6E, 0x46, 0x7C, 0x24, 0x6B, 0x26, 0x5C, 0x64, 0x7A, 0x5B, 0x49, 0x6C]\nfor i in range(len(a)):\n    print(chr(a[i] ^ i), end&#x3D;&#39;&#39;)\n\nFAKE&#123;WhAt-a-PitTY&#125;\nçœŸçš„{å¾ˆå¥½} (ç—´å‘†ğŸ¤¤)\nä»å¤´å†æ¥\næ ¹æ®è¿™ä½å¸ˆå‚…çš„wp\nREVERSE-COMPETITION-HWS-5TH-2022\nå‘ç°äº†Tlså‡½æ•°ï¼Œç¬¬ä¸€æ¬¡çŸ¥é“è¿™ä¸ªå‡½æ•°ï¼Œäº†è§£äº†ä¸€ä¸‹ï¼Œä»¥åéœ€è¦å¤šæ³¨æ„æ­¤ç±»å‹å‡½æ•°\nä»£ç é€†å‘åˆ†æé¢†åŸŸä¸­ï¼ŒTLSï¼ˆThread Local Storageï¼Œçº¿ç¨‹å±€éƒ¨å­˜å‚¨ï¼‰å›è°ƒå‡½æ•°ï¼ˆCallback Functionï¼‰å¸¸ç”¨åè°ƒè¯•ã€‚TLSå›è°ƒå‡½æ•°çš„è°ƒç”¨è¿è¡Œè¦å…ˆäºEPä»£ç çš„æ‰§è¡Œï¼Œè¯¥ç‰¹å¾ä½¿å®ƒå¯ä»¥ä½œä¸ºä¸€ç§åè°ƒè¯•æŠ€æœ¯çš„ä½¿ç”¨ã€‚\nTLSæ˜¯å„çº¿ç¨‹çš„ç‹¬ç«‹çš„æ•°æ®å­˜å‚¨ç©ºé—´ï¼Œä½¿ç”¨TLSæŠ€æœ¯å¯åœ¨çº¿ç¨‹å†…éƒ¨ç‹¬ç«‹ä½¿ç”¨æˆ–ä¿®æ”¹è¿›ç¨‹çš„å…¨å±€æ•°æ®æˆ–é™æ€æ•°æ®ï¼Œå°±åƒå¯¹å¾…è‡ªèº«çš„å±€éƒ¨å˜é‡ä¸€æ ·ã€‚\n\næ¥ç€åˆ†ææ­¤å‡½æ•°\nvoid __stdcall TlsCallback_0(int a1, DWORD flOldProtect, int a3)\n&#123;\n  int i; &#x2F;&#x2F; eax\n\n  if ( flOldProtect &#x3D;&#x3D; 1 )\n  &#123;\n    VirtualProtect(StartAddress, 0x320u, 0x40u, &amp;flOldProtect);\n    for ( i &#x3D; 0; i &lt; 800; ++i )\n      *((_BYTE *)StartAddress + i) ^&#x3D; i;\n    CreateThread(0, 0, StartAddress, 0, 0, 0);\n  &#125;\n&#125;\n\nè¿™æ˜¯ä¸€æ®µSMCï¼Œæ˜æ˜¾ç‰¹å¾ä¸ºå°†ä¸€æ®µæ•°ç»„ä½œä¸ºå‡½æ•°è°ƒç”¨\nå…ˆå°†è¿™æ®µä»£ç è¿˜åŸ\nimport idc\nstart_addr &#x3D; 0x401040\nend_addr &#x3D; start_addr + 800\nfor addr in range(start_addr, end_addr):\n    i &#x3D; addr - start_addr\n    by &#x3D; idc.get_wide_byte(addr)\n    ida_bytes.patch_byte(addr, by ^ i)\n\nè¿˜åŸåè¿˜æœ‰å°‘éƒ¨åˆ†ä»£ç idaæ²¡æœ‰åˆ†æåˆ°ä½ï¼Œæ‰¾åˆ°é‚£äº›åœ°æ–¹æŒ‰cåˆ†æä»£ç \nåˆ†æå®Œæ¯•ä¹‹åå†é€‰ä¸­StaatAddressè¿™ä¸€å¤§æ®µä»£ç ï¼ŒæŒ‰påˆ›å»ºå‡½æ•°ï¼Œè¿™æ ·å°±å¯ä»¥åç¼–è¯‘äº†\nDWORD __stdcall StartAddress(LPVOID lpThreadParameter)\n&#123;\n  int k; &#x2F;&#x2F; ebx\n  int v4; &#x2F;&#x2F; [esp-Ch] [ebp-50548h]\n  int v5; &#x2F;&#x2F; [esp-8h] [ebp-50544h]\n  int v6[65534]; &#x2F;&#x2F; [esp+Ch] [ebp-50530h]\n  char v7[66816]; &#x2F;&#x2F; [esp+40004h] [ebp-10538h] BYREF\n  int v8[6]; &#x2F;&#x2F; [esp+50504h] [ebp-38h]\n  char *v9; &#x2F;&#x2F; [esp+5051Ch] [ebp-20h]\n  int v10; &#x2F;&#x2F; [esp+50520h] [ebp-1Ch]\n  int v11; &#x2F;&#x2F; [esp+50524h] [ebp-18h]\n  int v12; &#x2F;&#x2F; [esp+50528h] [ebp-14h]\n  int v13; &#x2F;&#x2F; [esp+5052Ch] [ebp-10h]\n  int i; &#x2F;&#x2F; [esp+50530h] [ebp-Ch]\n  int v15; &#x2F;&#x2F; [esp+50534h] [ebp-8h]\n  int j; &#x2F;&#x2F; [esp+50538h] [ebp-4h]\n\n  while ( !dword_41B2E4 )\n    Sleep(0x3E8u);\n  for ( i &#x3D; 0; i &lt; 112; ++i )\n    byte_41B30A +&#x3D; *((_BYTE *)sub_401450 + i);\n  for ( i &#x3D; 0; input[i]; ++i )\n    input[i] ^&#x3D; byte_41B30A;\n  v8[0] &#x3D; &#39;Q&#39;;\n  v8[1] &#x3D; &#39;f&#39;;\n  v8[2] &#x3D; &#39;r&#39;;\n  v8[3] &#x3D; &#39;o&#39;;\n  v8[4] &#x3D; &#39;s&#39;;\n  v8[5] &#x3D; &#39;t&#39;;\n  for ( j &#x3D; 0; j &lt; 256; ++j )\n    *(_DWORD *)&amp;v7[4 * j + 65792] &#x3D; j;\n  for ( j &#x3D; 0; j &lt; 256; ++j )\n    v7[j + 0x10000] &#x3D; v8[j % 6];\n  v15 &#x3D; 0;\n  for ( j &#x3D; 0; j &lt; 256; ++j )\n  &#123;\n    v15 &#x3D; (v7[j + 0x10000] + *(_DWORD *)&amp;v7[4 * j + 65792] + v15) % 256;\n    v12 &#x3D; *(_DWORD *)&amp;v7[4 * j + 65792];\n    *(_DWORD *)&amp;v7[4 * j + 65792] &#x3D; *(_DWORD *)&amp;v7[4 * v15 + 65792];\n    *(_DWORD *)&amp;v7[4 * v15 + 65792] &#x3D; v12;\n  &#125;\n  v13 &#x3D; dword_41B2E8;\n  v11 &#x3D; 0;\n  v15 &#x3D; 0;\n  j &#x3D; 0;\n  while ( v13-- )\n  &#123;\n    j &#x3D; (j + 1) % 256;\n    v15 &#x3D; (*(_DWORD *)&amp;v7[4 * j + 65792] + v15) % 256;\n    v12 &#x3D; *(_DWORD *)&amp;v7[4 * j + 65792];\n    *(_DWORD *)&amp;v7[4 * j + 65792] &#x3D; *(_DWORD *)&amp;v7[4 * v15 + 65792];\n    *(_DWORD *)&amp;v7[4 * v15 + 65792] &#x3D; v12;\n    v10 &#x3D; (*(_DWORD *)&amp;v7[4 * v15 + 65792] + *(_DWORD *)&amp;v7[4 * j + 65792]) % 256;\n    v6[v11++] &#x3D; *(_DWORD *)&amp;v7[4 * v10 + 65792];\n  &#125;\n  for ( j &#x3D; 0; j &lt; dword_41B2E8; ++j )\n    v7[j] &#x3D; LOBYTE(v6[j]) ^ input[j];\n  v9 &#x3D; v7;\n  for ( k &#x3D; 0; k &lt; dword_41B2E8; ++k )\n  &#123;\n    if ( v9[k] !&#x3D; *(_BYTE *)(k + 0x401307) )\n    &#123;\n      sub_401010(4199237);\n      _loaddll(0);\n      break;\n    &#125;\n  &#125;\n  sub_401010((int)&quot;right\\n&quot;);\n  getchar(v4, v5);\n  return 0;\n&#125;\n\næ­¤å¤„å…ˆå°†input(ä¹Ÿå°±æ˜¯flag)ä¸byte_41B30Aå¼‚æˆ–ï¼Œç„¶åå¯¹inputè¿›è¡ŒRC4åŠ å¯†ï¼Œå¯†é’¥ä¸ºQfrost\næ ¹æ®é€»è¾‘æ±‚å‡ºbyte_41B30A\nimport idc\nstart_addr &#x3D; 0x401450\nend_addr &#x3D; start_addr + 112\nbyte_41B30A &#x3D; 0\nfor addr in range(start_addr, end_addr):\n    byte_41B30A +&#x3D; idc.get_wide_byte(addr)\nprint(hex(byte_41B30A &amp; 0xff))\n0x48\n\næ ¹æ®æœ€ååˆ¤æ–­çš„åœ°æ–¹0x401307æ‹¿åˆ°å¯†æ–‡\nå€Ÿç”¨å¸ˆå‚…çš„è„šæœ¬\n#include&lt;stdio.h&gt;\n\n&#x2F;&#x2F;RC4åˆå§‹åŒ–å‡½æ•°\nvoid rc4_init(unsigned char* s, unsigned char* key, unsigned long Len_k)&#123;\n\tunsigned int i &#x3D; 0, j &#x3D; 0;\n\tchar k[256] &#x3D; &#123; 0 &#125;;\n\tunsigned char tmp &#x3D; 0;\n\tfor (i &#x3D; 0; i &lt; 256; i++) &#123;\n\t\ts[i] &#x3D; i;\n\t\tk[i] &#x3D; key[i % Len_k];\n\t&#125;\n\tfor (i &#x3D; 0; i &lt; 256; i++) &#123;\n\t\tj &#x3D; (j + s[i] + k[i]) % 256;\n\t\ttmp &#x3D; s[i];\n\t\ts[i] &#x3D; s[j];\n\t\ts[j] &#x3D; tmp;\n\t&#125;\n&#125;\n\n&#x2F;*\nRC4åŠ è§£å¯†å‡½æ•°\nunsigned char* Data     åŠ è§£å¯†çš„æ•°æ®\nunsigned long Len_D     åŠ è§£å¯†æ•°æ®çš„é•¿åº¦\nunsigned char* key      å¯†é’¥\nunsigned long Len_k     å¯†é’¥é•¿åº¦\n*&#x2F;\nvoid rc4_crypt(unsigned char* Data, unsigned long Len_D, unsigned char* key, unsigned long Len_k)&#123;\n\tunsigned char s[256];\n\trc4_init(s, key, Len_k);\n\tint i &#x3D; 0, j &#x3D; 0, t &#x3D; 0;\n\tunsigned long k &#x3D; 0;\n\tunsigned char tmp;\n\tfor (k &#x3D; 0; k &lt; Len_D; k++) &#123;\n\t\ti &#x3D; (i + 1) % 256;\n\t\tj &#x3D; (j + s[i]) % 256;\n\t\ttmp &#x3D; s[i];\n\t\ts[i] &#x3D; s[j];\n\t\ts[j] &#x3D; tmp;\n\t\tt &#x3D; (s[i] + s[j]) % 256;\n\t\tData[k] &#x3D; Data[k] ^ s[t];\n\t&#125;\n&#125;\n\nint main()&#123;\n\t&#x2F;&#x2F;å­—ç¬¦ä¸²å¯†é’¥\n\tunsigned char key[] &#x3D; &quot;Qfrost&quot;;\n\tunsigned long key_len &#x3D; sizeof(key) - 1;\n\t&#x2F;*\n\t&#x2F;&#x2F;æ•°ç»„å¯†é’¥\n\tunsigned char key[] &#x3D; &#123;0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef,0xfe,0xdc,0xba,0x98,0x76,0x54,0x32,0x10&#125;;\n\tunsigned long key_len &#x3D; sizeof(key);\n    *&#x2F;\n\t&#x2F;&#x2F;åŠ è§£å¯†æ•°æ®\n\tunsigned char data[] &#x3D; &#123;0x7F, 0xB6, 0x88, 0x12, 0xDC, 0xC3, 0xDE, 0xDB, 0x30, 0x24, \n    0xE3, 0xC1, 0x0F, 0xC9, 0x7F, 0xC2, 0x4D, 0x9C, 0x6B, 0x02, \n    0x26, 0x20, 0xF1, 0x25, 0xA0, 0xE3, 0xC6, 0xDE &#125;;\n\t&#x2F;&#x2F;åŠ è§£å¯†\n\trc4_crypt(data, sizeof(data), key, key_len);\n\n\tfor (int i &#x3D; 0; i &lt; sizeof(data); i++)&#123;\n\t\tprintf(&quot;%c&quot;, data[i] ^ 0x48);  &#x2F;&#x2F;0x48å³byte_41B30A\n\t&#125;\n\treturn 0;\n&#125;\n\nQDbg-Is_an_1ntereSting-Game!\nre3æ‹¿åˆ°æºæ–‡ä»¶ctf.apkï¼Œæ”¾è¿›jadxä¸­ï¼Œæ‰¾åˆ°MainActicity\n\nå‘ç°å…³é”®åœ¨äºè¿™ä¸ªnative checkå‡½æ•°ï¼Œç”¨apktoolåç¼–è¯‘apkï¼Œè¿›å…¥libç›®å½•ï¼Œå°†é‡Œé¢çš„soæ–‡ä»¶æ”¾è¿›ida\nå®¹æ˜“æ‰¾åˆ°å…³é”®å‡½æ•°ï¼š\nbool __fastcall sub_D060(int a1, int a2, int a3)\n&#123;\n  const char *v4; &#x2F;&#x2F; [sp+20h] [bp-490h]\n  size_t i; &#x2F;&#x2F; [sp+28h] [bp-488h]\n  size_t v9; &#x2F;&#x2F; [sp+7Ch] [bp-434h]\n  char v10[272]; &#x2F;&#x2F; [sp+80h] [bp-430h] BYREF\n  char v11[272]; &#x2F;&#x2F; [sp+190h] [bp-320h] BYREF\n  int v12[132]; &#x2F;&#x2F; [sp+2A0h] [bp-210h] BYREF\n\n  memset(v12, 0, 0x204u);\n  v12[0] &#x3D; 1024;\n  memset(v11, 0, sizeof(v11));\n  memset(v10, 0, sizeof(v10));\n  v4 &#x3D; (const char *)_JNIEnv::GetStringUTFChars(a1, a3, 0);\n  v9 &#x3D; strlen(v4);\n  if ( (unsigned __int8)v9 &lt;&lt; 31 || v9 &gt; 0x200 || v9 &lt;&#x3D; 0xF )\n    return 0;\n  for ( i &#x3D; 0; i &lt; v9 &gt;&gt; 1; ++i )\n  &#123;\n    v10[i] &#x3D; v4[2 * i] - 48;\n    if ( (unsigned __int8)v10[i] &gt;&#x3D; 0xAu )\n      v10[i] -&#x3D; 39;\n    v10[i] +&#x3D; 36 * v4[2 * i + 1] + 64;\n  &#125;\n  _memcpy_chk((char *)&amp;v12[38] + 3, &amp;unk_7721, 105, 361);\n  _memcpy_chk((char *)&amp;v12[128] + 1, &amp;unk_778A, 3, 3);\n  sub_2304(v11);\n  return strncmp(&amp;v11[108], sure_flag, 0x14u) &#x3D;&#x3D; 0;\n&#125;\n\nforå¾ªç¯æ˜¯è½¬æ¢36è¿›åˆ¶çš„å­—ç¬¦ä¸²ä¸º16è¿›åˆ¶\nsub_31D0æ®wpè¯´æ˜¯RSAåŠ å¯†å‡½æ•°ï¼Œttttclçœ‹ä¸å‡ºæ¥ï¼Œnå’Œeå·²çŸ¥\næœ€åå°†å¾—åˆ°çš„å€¼å’Œsure_flagä½œæ¯”è¾ƒ\nsure_flag:49 20 61 6D 20 73 75 72 65 20 69 74 20 69 73 20 66 6C 34 67 00\nå€Ÿç”¨exp\nimport gmpy2\n\nn &#x3D; 0x7019325b70f4a2f26e921102a0206de415caeb535cd4ec9d23d6608630dd00a9db5db8faef4621ccb2e775844c7447a1a843ebac03eca6f329feabcd6560b80aacf7a54a298548827c9d75e1450fcf7e53dac37c0f7fd25d509c342c23bda0619504b28ec903c56c87\np &#x3D; 1475203612633975218848450285487339190962027688336790188873776418606441616307026173067\nq &#x3D; 1475203612633975218848450285487339190962027688336790188873776418606441616307046219549\nr &#x3D; 1475203612633975218848450285487339190962027688336790188873776418606441616307129708089\ne &#x3D; 0x10001\nphi &#x3D; (p - 1) * (q - 1) * (r - 1)\nd &#x3D; gmpy2.invert(e, phi)\nc &#x3D; 0x4920616D207375726520697420697320666C3467\nm &#x3D; gmpy2.powmod(c, d, n)\ns &#x3D; hex(m)[2:]\nflag &#x3D; &quot;&quot;\nfor i in range(0, len(s), 2):\n    tmp &#x3D; int(s[i:i + 2], 16)\n    if tmp &lt; 100:\n        flag +&#x3D; &quot;0&quot;\n    flag +&#x3D; str(tmp)\nprint(flag)\n\n037087131219012107229231067248093076089082070175138132195124126254031088197066063081248248223201185154047168242228140155089071245228045160218140167117182217137118206104215018068031237111113041220252131252040018130017184197145113066057103096226240251147039224115177108218078236161028053035089246229073211242029209057\n\nè¾“å…¥ç¨‹åºä¸­éªŒè¯æ­£ç¡®\nå¼ºç½‘æ¯GameMasteræ‹¿åˆ°é¢˜ç›®ä¸‰ä¸ªæ–‡ä»¶\n\næ ¸å¿ƒæ–‡ä»¶BlackjackConsole.exeæ˜“çŸ¥æ˜¯åŸºäº.NETæ¡†æ¶ï¼Œc#ç¼–å†™çš„æ–‡ä»¶\næ‰€ä»¥æˆ‘ä»¬ç”¨ç¥å™¨dnSpyæ‰“å¼€å®ƒ\n\nè¿›å…¥Programåˆ†æï¼Œå› ä¸ºc#ä¹Ÿæ˜¯é¢å¯¹å¯¹è±¡çš„ï¼Œæ‰€ä»¥æœ‰javaåŸºç¡€çš„è¯çœ‹ä»£ç è¿˜æ˜¯æ¯”è¾ƒå¥½æ‡‚çš„\nå•ç‹¬åˆ†æ19è¡Œåˆ°23è¡Œè¿™å‡ å¥ä»£ç ï¼Œå› ä¸ºå®ƒéå¸¸æ˜¾çœ¼ï¼Œå¯¹é¢˜ç›®ä¸­çš„â€gamemessageâ€æ–‡ä»¶è¿›è¡Œäº†æ“ä½œ\n19\t\t\tFileStream fileStream &#x3D; File.OpenRead(&quot;gamemessage&quot;);\n20\t\t\tint num &#x3D; (int)fileStream.Length;\n21\t\t\tProgram.memory &#x3D; new byte[num];\n22\t\t\tfileStream.Position &#x3D; 0L;\n23\t\t\tfileStream.Read(Program.memory, 0, num);\n\nå°±æ˜¯å°†gamemessageé‡Œçš„å†…å®¹è¯»å–åˆ°äº†æ–°åˆ›çš„çš„ä¸€ä¸ªbyteæ•°ç»„memoryä¸­\næ¥ç€å¾€ä¸‹åˆ†æï¼Œè¿™äº›æ˜¯æ¸¸æˆåˆå§‹åŒ–çš„å†…å®¹ï¼Œä¸æ˜¯é‡ç‚¹ï¼Œä¸€ç›´å¾€ä¸‹æ»‘å‘ç°è¿™ä¸€æ®µ\n567\t\t\t\tfor (int i &#x3D; 0; i &lt; Program.memory.Length; i++)\n568\t\t\t\t&#123;\n569\t\t\t\t\tbyte[] array &#x3D; Program.memory;\n570\t\t\t\t\tint num &#x3D; i;\n571\t\t\t\t\tarray[num] ^&#x3D; 34;\n572\t\t\t\t&#125;\n573\t\t\t\tEnvironment.SetEnvironmentVariable(&quot;AchivePoint1&quot;, game.Player.Balance.ToString());\n\nè¿™ä¸€æ®µå¯¹memoryè¿›è¡Œäº†å¼‚æˆ–34çš„æ“ä½œ\nç»§ç»­å¾€ä¸‹ï¼Œå‘ç°\n813\t            byte[] key &#x3D; new byte[]\n814             &#123;\n815                 66,\n816                 114,\n817                 97,\n818                 105,\n819                 110,\n820                 115,\n821                 116,\n822                 111,\n823                 114,\n824                 109,\n825                 105,\n826                 110,\n827                 103,\n828                 33,\n829                 33,\n830                 33\n831             &#125;;\n832             ICryptoTransform cryptoTransform &#x3D; new RijndaelManaged\n833             &#123;\n834                 Key &#x3D; key,\n835                 Mode &#x3D; CipherMode.ECB,\n836                 Padding &#x3D; PaddingMode.Zeros\n837             &#125;.CreateDecryptor();\n838             Program.m &#x3D; cryptoTransform.TransformFinalBlock(Program.memory, 0, Program.memory.Length);\n839             Environment.SetEnvironmentVariable(&quot;AchivePoint2&quot;, game.Player.Balance.ToString());\n\nkeyæ•°ç»„ï¼ŒECBæ¨¡å¼ï¼ŒZeroså¡«å……ï¼Œå¯¹memoryè¿›è¡ŒåŠ å¯†ï¼ŒæŸ¥æ–‡æ¡£å¾—çŸ¥æ­¤ä¸ºAESåŠ å¯†\næ—¢ç„¶çŸ¥é“å¯¹gamemessageè¿›è¡Œäº†ä»€ä¹ˆæ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬å¼€å§‹å¤ç°è¿™ä¸¤ä¸ªæ“ä½œ\né¦–å…ˆæ˜¯è¯»å–gamemessageï¼Œå°†å…¶å¯¹34è¿›è¡Œå¼‚æˆ–å¾—åˆ°gamemessage_2æ–‡ä»¶\nwith open(&#39;gamemessage&#39;,&#39;rb&#39;) as f:\n    with open(&#39;gamemessage_2&#39;,&#39;wb&#39;) as f_2:\n        b&#x3D;f.read()\n        for i in range(len(b)):\n            f_2.write((b[i] ^ 34).to_bytes(1,&#39;little&#39;))\n\nå†å¯¹å…¶è¿›è¡ŒAESè§£å¯†ï¼Œå¯†é’¥ä¸ºbâ€™Brainstorming!!!â€™ï¼ŒECBæ¨¡å¼ï¼ŒZeroså¡«å……\n\nå°†è§£å¯†å‡ºæ¥çš„æ•°æ®å†™å…¥æ–‡ä»¶gamemessage_AESä¸­ï¼Œå†ç”¨010 editoræ‰“å¼€\n\nå‘ç°å¤´éƒ¨å¾ˆå¤šå¯ç–‘ä¿¡æ¯ç±»ä¼¼ç³»ç»ŸAPIçš„ä¸œè¥¿\nå¯ä»¥ç”¨binwalkæ‰«ä¸€ä¸‹\n\næœç„¶å‘ç°åœ¨0x13EBå¤„æœ‰PEæ–‡ä»¶å¤´æ ‡å¿—â€MZâ€\n\nç›´æ¥æŠŠâ€MZâ€ä¹‹å‰çš„æ•°æ®åˆ æ‰ï¼Œå¾—åˆ°æ–°çš„PEæ–‡ä»¶ï¼Œå®ƒä»æ˜¯.NETæ¡†æ¶ä¸‹çš„æ–‡ä»¶ï¼Œå†ç”¨dnSpyæ‰“å¼€å®ƒ\nå‘ç°è¿™ä¹ˆæ®µä»£ç \nusing System;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\n\nnamespace T1Class&#123;\n\t&#x2F;&#x2F; Token: 0x02000002 RID: 2\n\tpublic class T1&#123;\n\t\t&#x2F;&#x2F; Token: 0x06000001 RID: 1 RVA: 0x00002050 File Offset: 0x00000250\n\t\tprivate static void Check1(ulong x, ulong y, ulong z, byte[] KeyStream)&#123;\n\t\t\tint num &#x3D; -1;\n\t\t\tfor (int i &#x3D; 0; i &lt; 320; i++)&#123;\n\t\t\t\tx &#x3D; (((x &gt;&gt; 29 ^ x &gt;&gt; 28 ^ x &gt;&gt; 25 ^ x &gt;&gt; 23) &amp; 1UL) | x &lt;&lt; 1);\n\t\t\t\ty &#x3D; (((y &gt;&gt; 30 ^ y &gt;&gt; 27) &amp; 1UL) | y &lt;&lt; 1);\n\t\t\t\tz &#x3D; (((z &gt;&gt; 31 ^ z &gt;&gt; 30 ^ z &gt;&gt; 29 ^ z &gt;&gt; 28 ^ z &gt;&gt; 26 ^ z &gt;&gt; 24) &amp; 1UL) | z &lt;&lt; 1);\n\t\t\t\tbool flag &#x3D; i % 8 &#x3D;&#x3D; 0;\n\t\t\t\tif (flag)&#123;\n\t\t\t\t\tnum++;\n\t\t\t\t&#125;\n\t\t\t\tKeyStream[num] &#x3D; (byte)((long)((long)KeyStream[num] &lt;&lt; 1) | (long)((ulong)((uint)((z &gt;&gt; 32 &amp; 1UL &amp; (x &gt;&gt; 30 &amp; 1UL)) ^ (((z &gt;&gt; 32 &amp; 1UL) ^ 1UL) &amp; (y &gt;&gt; 31 &amp; 1UL))))));\n\t\t\t&#125;\n\t\t&#125;\n\n\t\t&#x2F;&#x2F; Token: 0x06000002 RID: 2 RVA: 0x00002110 File Offset: 0x00000310\n\t\tprivate static void ParseKey(ulong[] L, byte[] Key)&#123;\n\t\t\tfor (int i &#x3D; 0; i &lt; 3; i++)&#123;\n\t\t\t\tfor (int j &#x3D; 0; j &lt; 4; j++)&#123;\n\t\t\t\t\tKey[i * 4 + j] &#x3D; (byte)(L[i] &gt;&gt; j * 8 &amp; 255UL);\n\t\t\t\t&#125;\n\t\t\t&#125;\n\t\t&#125;\n\n\t\t&#x2F;&#x2F; Token: 0x06000003 RID: 3 RVA: 0x0000215C File Offset: 0x0000035C\n\t\tpublic T1()&#123;\n\t\t\ttry&#123;\n\t\t\t\tstring environmentVariable &#x3D; Environment.GetEnvironmentVariable(&quot;AchivePoint1&quot;);\n\t\t\t\tstring environmentVariable2 &#x3D; Environment.GetEnvironmentVariable(&quot;AchivePoint2&quot;);\n\t\t\t\tstring environmentVariable3 &#x3D; Environment.GetEnvironmentVariable(&quot;AchivePoint3&quot;);\n\t\t\t\tbool flag &#x3D; environmentVariable &#x3D;&#x3D; null || environmentVariable2 &#x3D;&#x3D; null || environmentVariable3 &#x3D;&#x3D; null;\n\t\t\t\tif (!flag)&#123;\n\t\t\t\t\tulong num &#x3D; ulong.Parse(environmentVariable);\n\t\t\t\t\tulong num2 &#x3D; ulong.Parse(environmentVariable2);\n\t\t\t\t\tulong num3 &#x3D; ulong.Parse(environmentVariable3);\n\t\t\t\t\tulong[] array &#x3D; new ulong[3];\n\t\t\t\t\tbyte[] array2 &#x3D; new byte[40];\n\t\t\t\t\tbyte[] array3 &#x3D; new byte[40];\n\t\t\t\t\tbyte[] array4 &#x3D; new byte[12];\n\t\t\t\t\tbyte[] first &#x3D; new byte[]&#123;\n\t\t\t\t\t\t101,5,80,213,163,26,59,38,19,6,173,189,198,166,140,183,42,247,223,24,106,20,145,37,24,7,22,191,110,179,227,5,62,9,13,17,65,22,37,5\n\t\t\t\t\t&#125;;\n\t\t\t\t\tbyte[] array5 &#x3D; new byte[]&#123;\n\t\t\t\t\t\t60,100,36,86,51,251,167,108,116,245,207,223,40,103,34,62,22,251,227\n\t\t\t\t\t&#125;;\n\t\t\t\t\tarray[0] &#x3D; num;\n\t\t\t\t\tarray[1] &#x3D; num2;\n\t\t\t\t\tarray[2] &#x3D; num3;\n\t\t\t\t\tT1.Check1(array[0], array[1], array[2], array2);\n\t\t\t\t\tbool flag2 &#x3D; first.SequenceEqual(array2);\n\t\t\t\t\tif (flag2)&#123;\n\t\t\t\t\t\tT1.ParseKey(array, array4);\n\t\t\t\t\t\tfor (int i &#x3D; 0; i &lt; array5.Length; i++)&#123;\n\t\t\t\t\t\t\tarray5[i] ^&#x3D; array4[i % array4.Length];\n\t\t\t\t\t\t&#125;\n\t\t\t\t\t\tMessageBox.Show(&quot;flag&#123;&quot; + Encoding.Default.GetString(array5) + &quot;&#125;&quot;, &quot;Congratulations!&quot;, MessageBoxButtons.OK);\n\t\t\t\t\t&#125;\n\t\t\t\t&#125;\n\t\t\t&#125;\n\t\t\tcatch (Exception)&#123;\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;\n&#125;\n\né€»è¾‘å¤§è‡´å¦‚ä¸‹ï¼šæ±‚flag-&gt;å·²çŸ¥array5-&gt;æ±‚array4-&gt;ParseKeyå‡½æ•°-&gt;æ±‚array-&gt;Check1å‡½æ•°-&gt;æ±‚array2-&gt;å·²çŸ¥first\næ ¹æ®è¿™ä½å¸ˆå‚…çš„wp\n[2022å¼ºç½‘æ¯ â€Reverseâ€œ WP](https://blog.jamiexu.cn/2022/08/01/ã€CTF&amp;WriteUP&amp;Reã€‘2022å¼ºç½‘æ¯ â€Reverseâ€œ WriteUp&#x2F;)\nexpæ±‚è§£array\nimport z3\n\nfirst &#x3D; [\n  101, 5, 80, 213, 163, 26, 59, 38, 19, 6, 173, 189, 198, 166, 140, 183, 42, 247, 223, 24, 106, 20, 145, 37, 24, 7, 22, 191, 110, 179, 227, 5, 62, 9, 13, 17, 65, 22, 37, 5\n]\narray2 &#x3D; [0] * len(first)\nx &#x3D; z3.BitVec(&quot;x&quot;, 64)\ny &#x3D; z3.BitVec(&quot;y&quot;, 64)\nz &#x3D; z3.BitVec(&quot;z&quot;, 64)\nnum &#x3D; -1\nfor i in range(320):\n    x &#x3D; (((x &gt;&gt; 29 ^ x &gt;&gt; 28 ^ x &gt;&gt; 25 ^ x &gt;&gt; 23) &amp; 1) | x &lt;&lt; 1)\n    y &#x3D; (((y &gt;&gt; 30 ^ y &gt;&gt; 27) &amp; 1) | y &lt;&lt; 1)\n    z &#x3D; (((z &gt;&gt; 31 ^ z &gt;&gt; 30 ^ z &gt;&gt; 29 ^ z &gt;&gt; 28 ^ z &gt;&gt; 26 ^ z &gt;&gt; 24) &amp; 1) | z &lt;&lt; 1)\n    if i % 8 &#x3D;&#x3D; 0:\n        num +&#x3D; 1\n    array2[num] &#x3D; ((array2[num] &lt;&lt; 1) | (z &gt;&gt; 32 &amp; 1 &amp; (x &gt;&gt; 30 &amp; 1) ^ ((z &gt;&gt; 32 &amp; 1) ^ 1) &amp; (y &gt;&gt; 31 &amp; 1)))\n\nsolver &#x3D; z3.Solver()\nfor i in range(len(first)):\n    solver.add(first[i] &#x3D;&#x3D; array2[i])\n\nif solver.check() &#x3D;&#x3D; z3.sat:\n    model &#x3D; solver.model()\n    print(model)\n \n[y &#x3D; 868387187, x &#x3D; 156324965, z &#x3D; 3131229747]\n\næœ€åç›´æ¥å¼‚æˆ–å°±è¡Œäº†\narray &#x3D; [156324965, 868387187, 3131229747]\narray4 &#x3D; [0] * 12\nfor i in range(3):\n    for j in range(4):\n        array4[i * 4 + j] &#x3D; (array[i] &gt;&gt; j * 8 &amp; 255)\n\narray5 &#x3D; [60, 100, 36, 86, 51, 251, 167, 108, 116, 245, 207, 223, 40, 103, 34, 62, 22, 251, 227]\nfor i in range(len(array5)):\n    print(chr(array5[i] ^ array4[i % len(array4)]), end&#x3D;&#39;&#39;)\n\nY0u_@re_G3meM3s7er!\neasyreé¢˜ç›®çš„æç¤ºæ˜¯flagè—åœ¨è¾“å…¥é‡Œé¢ï¼Œå…ˆæ”¾åœ¨ä¸€è¾¹ï¼Œå¯èƒ½ä¼šç”¨ä¸Š\næ‹¿åˆ°æºæ–‡ä»¶ï¼ŒæŸ¥ä¸€ä¸‹æ˜¯64ä½elfæ–‡ä»¶æ”¾è¿›ida64é‡Œ\n__int64 __fastcall sub_4021BB(__int64 a1, __int64 a2, double a3, double a4, double a5, double a6, double a7, double a8, double a9, double a10)\n&#123;\n  double v10; &#x2F;&#x2F; xmm4_8\n  double v11; &#x2F;&#x2F; xmm5_8\n  unsigned int v13; &#x2F;&#x2F; [rsp+1Ch] [rbp-4h]\n\n  sub_402150();\n  v13 &#x3D; sub_44B420();\n  if ( v13 )\n  &#123;\n    sub_401F2F(v13);\n    sub_40C3F0((__int64)&quot;re3&quot;);\n  &#125;\n  else\n  &#123;\n    sub_44CC50(0LL, 0LL, 0LL, 0LL);\n    sub_44B680((__int64)&quot;re3&quot;, (__int64)&quot;re3&quot;, a3, a4, a5, a6, v10, v11, a9, a10, *(_QWORD *)(a2 + 8), 0LL);\n  &#125;\n  return 0LL;\n&#125;\n\nè¿›å…¥ç¬¬ä¸€ä¸ªå‡½æ•°sub_402150()çœ‹çœ‹\n__int64 sub_402150()\n&#123;\n  __int64 v1; &#x2F;&#x2F; [rsp+8h] [rbp-8h]\n\n  v1 &#x3D; sub_40CFA0(&quot;re3&quot;, &quot;wb&quot;);\n  sub_40CFB0(&amp;unk_4BC380, 1LL, (unsigned int)dword_4C2070, v1);\n  sub_40C920(v1);\n  return sub_44BE20(&quot;re3&quot;, 511LL);\n&#125;\n\nå‘ç°å®ƒæ˜¯åœ¨å†™ä¸€ä¸ªre3çš„æ–‡ä»¶ï¼Œè€Œunk_4BC380è¿™ä¸ªåœ°å€å«æœ‰æ˜æ˜¾çš„elfæ–‡ä»¶å¤´ï¼Œåé¢çš„dword_4C2070ä¸ºé•¿åº¦ï¼š0x5cf0\n\né‚£ä¹ˆæˆ‘ä»¬æŠŠè¿™ä¸ªre3æå‡ºæ¥\nimport idc\nstart_addr &#x3D; 0x4BC380\nend_addr &#x3D; start_addr + 0x5cf0\nf &#x3D; open(&quot;re3&quot;,&quot;wb&quot;)\nfor addr in range(startaddr, endaddr):\n    f.write(idc.get_wide_byte(addr).to_bytes(1, &#39;little&#39;))\nf.close()\n\nå¾—åˆ°çš„re3ä¹Ÿæ˜¯ä¸€ä¸ª64ä½elfæ–‡ä»¶ï¼ŒåŒæ ·æ”¾è¿›ida64ä¸­ï¼Œmainå‡½æ•°å¦‚ä¸‹\n\nå…ˆè¯•ä¸€ä¸‹æŒ‰cè½¬æ¢æˆä»£ç ï¼Œå†æŒ‰påˆ›å»ºå‡½æ•°ï¼ŒæˆåŠŸå¾—åˆ°ä¸»å‡½æ•°\n__int64 __fastcall main(int a1, char **a2, char **a3)\n&#123;\n  struct __jmp_buf_tag env[1]; &#x2F;&#x2F; [rsp+10h] [rbp-850h] BYREF\n  struct __jmp_buf_tag v5[1]; &#x2F;&#x2F; [rsp+E0h] [rbp-780h] BYREF\n  struct __jmp_buf_tag v6[1]; &#x2F;&#x2F; [rsp+1B0h] [rbp-6B0h] BYREF\n  struct __jmp_buf_tag v7[1]; &#x2F;&#x2F; [rsp+280h] [rbp-5E0h] BYREF\n  char v8[640]; &#x2F;&#x2F; [rsp+350h] [rbp-510h] BYREF\n  char v9[636]; &#x2F;&#x2F; [rsp+5D0h] [rbp-290h] BYREF\n  int v10; &#x2F;&#x2F; [rsp+84Ch] [rbp-14h]\n  int v11; &#x2F;&#x2F; [rsp+850h] [rbp-10h]\n  int v12; &#x2F;&#x2F; [rsp+854h] [rbp-Ch]\n  int v13; &#x2F;&#x2F; [rsp+858h] [rbp-8h]\n  int v14; &#x2F;&#x2F; [rsp+85Ch] [rbp-4h]\n  __int64 savedregs; &#x2F;&#x2F; [rsp+860h] [rbp+0h] BYREF\n\n  v14 &#x3D; 1;\n  if ( a1 !&#x3D; 2 )\n    return 0LL;\n  sub_2490(a2[1]);\n  ((void (__fastcall *)(_BYTE *, char *, char *))loc_21F9)(byte_55C0, v9, v8);\n  v13 &#x3D; _setjmp(env);\n  if ( v13 &lt;&#x3D; 24 )\n  &#123;\n    v11 &#x3D; _setjmp(v5);\n    if ( v11 &lt; byte_50A0[25 * v13] )\n    &#123;\n      if ( byte_50A0[25 * v13 + 1 + v11] !&#x3D; *((char *)&amp;savedregs + 25 * v13 + v11 - 655) )\n        v14 &#x3D; 0;\n      longjmp(v5, v11 + 1);\n    &#125;\n    longjmp(env, v13 + 1);\n  &#125;\n  v12 &#x3D; _setjmp(v6);\n  if ( v12 &lt;&#x3D; 24 )\n  &#123;\n    v10 &#x3D; _setjmp(v7);\n    if ( v10 &lt; byte_5320[25 * v12] )\n    &#123;\n      if ( byte_5320[25 * v12 + 1 + v10] !&#x3D; *((char *)&amp;savedregs + 25 * v12 + v10 - 1295) )\n        v14 &#x3D; 0;\n      longjmp(v7, v10 + 1);\n    &#125;\n    longjmp(v6, v12 + 1);\n  &#125;\n  if ( v14 &#x3D;&#x3D; 1 )\n    puts(&quot;GOOD JOB&quot;);\n  return 0LL;\n&#125;\n\nä¸¤ä¸ªäºŒç»´æ•°ç»„byte_50A0å’Œbyte_5320\næå‡ºæ¥å‘ç°æ˜¯ä¸ª25*25çš„æ•°ç»‡æ¸¸æˆ\nç»“åˆä¹‹å‰çš„æç¤ºï¼Œè§£å‡ºæ¥è¿™ä¸ªæ¸¸æˆåº”è¯¥å°±èƒ½æ‹¿åˆ°flag\nhttps://handsomeone.github.io/Nonogram/\né€šè¿‡è¿™ä¸ªåœ¨çº¿ç½‘ç«™è§£å‡ºç­”æ¡ˆ\n\nemmmï¼Œè¢«å‘äº†ï¼Œä¸å¯¹ï¼Œå›åˆ°idaï¼Œç”¨åˆ†æä¸»å‡½æ•°çš„æ–¹æ³•åˆåˆ†æåˆ°å‡ ä¸ªå¯ç–‘çš„å‡½æ•°\nchar *sub_265C()\n&#123;\n  unsigned int v0; &#x2F;&#x2F; eax\n  char *result; &#x2F;&#x2F; rax\n  char v2[639]; &#x2F;&#x2F; [rsp+0h] [rbp-300h] BYREF\n  char needle[2]; &#x2F;&#x2F; [rsp+27Fh] [rbp-81h] BYREF\n  char v4; &#x2F;&#x2F; [rsp+281h] [rbp-7Fh]\n  char v5[4]; &#x2F;&#x2F; [rsp+282h] [rbp-7Eh] BYREF\n  __int16 v6; &#x2F;&#x2F; [rsp+286h] [rbp-7Ah]\n  char v7[4]; &#x2F;&#x2F; [rsp+288h] [rbp-78h] BYREF\n  __int16 v8; &#x2F;&#x2F; [rsp+28Ch] [rbp-74h]\n  char v9[2]; &#x2F;&#x2F; [rsp+28Eh] [rbp-72h] BYREF\n  char v10; &#x2F;&#x2F; [rsp+290h] [rbp-70h]\n  char format[8]; &#x2F;&#x2F; [rsp+291h] [rbp-6Fh] BYREF\n  int v12; &#x2F;&#x2F; [rsp+299h] [rbp-67h]\n  __int16 v13; &#x2F;&#x2F; [rsp+29Dh] [rbp-63h]\n  char v14; &#x2F;&#x2F; [rsp+29Fh] [rbp-61h]\n  char haystack[16]; &#x2F;&#x2F; [rsp+2A0h] [rbp-60h] BYREF\n  char s[32]; &#x2F;&#x2F; [rsp+2B0h] [rbp-50h] BYREF\n  __int64 v17; &#x2F;&#x2F; [rsp+2D0h] [rbp-30h]\n  int v18; &#x2F;&#x2F; [rsp+2DCh] [rbp-24h]\n  FILE *stream; &#x2F;&#x2F; [rsp+2E0h] [rbp-20h]\n  int n; &#x2F;&#x2F; [rsp+2E8h] [rbp-18h]\n  int m; &#x2F;&#x2F; [rsp+2ECh] [rbp-14h]\n  int l; &#x2F;&#x2F; [rsp+2F0h] [rbp-10h]\n  int k; &#x2F;&#x2F; [rsp+2F4h] [rbp-Ch]\n  int j; &#x2F;&#x2F; [rsp+2F8h] [rbp-8h]\n  int i; &#x2F;&#x2F; [rsp+2FCh] [rbp-4h]\n\n  *(_QWORD *)format &#x3D; 0xEAABA1EDE1FCFEA1LL;\n  v12 &#x3D; -268763743;\n  v13 &#x3D; -1030;\n  v14 &#x3D; -3;\n  *(_WORD *)v9 &#x3D; -5399;\n  v10 &#x3D; -20;\n  *(_DWORD *)v7 &#x3D; -268633374;\n  v8 &#x3D; -5139;\n  *(_DWORD *)v5 &#x3D; -268633347;\n  v6 &#x3D; -5139;\n  *(_WORD *)needle &#x3D; -5401;\n  v4 &#x3D; -17;\n  for ( i &#x3D; 0; i &lt;&#x3D; 14; ++i )\n    format[i] ^&#x3D; 0x8Eu;\n  for ( j &#x3D; 0; j &lt;&#x3D; 2; ++j )\n    v9[j] ^&#x3D; 0x8Eu;\n  for ( k &#x3D; 0; k &lt;&#x3D; 5; ++k )\n    v7[k] ^&#x3D; 0x8Eu;\n  for ( l &#x3D; 0; l &lt;&#x3D; 5; ++l )\n    v5[l] ^&#x3D; 0x8Eu;\n  for ( m &#x3D; 0; m &lt;&#x3D; 5; ++m )\n    needle[m] ^&#x3D; 0x8Eu;\n  v0 &#x3D; getppid();\n  snprintf(s, 0x1EuLL, format, v0);\n  stream &#x3D; fopen(s, &quot;r&quot;);\n  fgets(haystack, 16, stream);\n  fclose(stream);\n  result &#x3D; (char *)(strstr(haystack, needle) || strstr(haystack, v9) || strstr(haystack, v7) || strstr(haystack, v5));\n  v18 &#x3D; (int)result;\n  if ( !(_DWORD)result )\n  &#123;\n    qmemcpy(v2, &amp;unk_32A0, 0x271uLL);\n    result &#x3D; (char *)&amp;unk_5834 - 1940;\n    v17 &#x3D; (__int64)&amp;unk_5834 - 1940;\n    for ( n &#x3D; 0; n &lt;&#x3D; 24; ++n )\n      result &#x3D; (char *)memcpy((void *)(25 * n + v17), &amp;v2[25 * n], (unsigned __int8)v2[25 * n] + 1);\n  &#125;\n  return result;\n&#125;\n\n\n__int64 sub_257D()\n&#123;\n  char v1[640]; &#x2F;&#x2F; [rsp+0h] [rbp-290h] BYREF\n  __int64 v2; &#x2F;&#x2F; [rsp+280h] [rbp-10h]\n  int i; &#x2F;&#x2F; [rsp+28Ch] [rbp-4h]\n\n  qmemcpy(v1, &amp;unk_3020, 0x271uLL);\n  v2 &#x3D; (__int64)&amp;unk_5838 - 1304;\n  for ( i &#x3D; 0; i &lt;&#x3D; 24; ++i )\n    memcpy((void *)(25 * i + v2), &amp;v1[25 * i], (unsigned __int8)v1[25 * i] + 1);\n  return nullsub_2();\n&#125;\n\nsub_265Cé‡Œé¢çš„&amp;unk_32A0å’Œsub_257Dé‡Œé¢çš„&amp;unk_3020ä¹Ÿæ˜¯25*25çš„äºŒç»´æ•°ç»„éå¸¸å¯ç–‘\næå‡ºæ¥å½“ä½œæ•°ç»‡çš„è¡Œå’Œåˆ—å†è§£ä¸€é\n\nå—¯ï¼Œå¯¹å‘³\nFLAG&#123;I LOVE PLAY ctf_QWB2022&#125;","slug":"20220803-hws-qwb-recurrent","date":"2022-08-03T03:00:00.000Z","categories_index":"Write Up","tags_index":"ctf,wp,reverse","author_index":"y9nhjy"},{"id":"ebb392945466e3b28411a4ab0abfa6f9","title":"2022-HWSå¤ä»¤è¥é¢„é€‰èµ›","content":"2022-HWSå¤ä»¤è¥é¢„é€‰èµ›\næ¯”èµ›ï¼šHWSè®¡åˆ’ç¬¬äº”æœŸ-2022ç¡¬ä»¶å®‰å…¨åœ¨çº¿å¤ä»¤è¥çº¿ä¸Šé¢„é€‰èµ›\næ—¶é—´ï¼š2022-07-29 09:00:00~2022-08-01 21:00:00\nReverse\nâ€‹\tre1\nCrypto\nâ€‹\teasyRSA\nMsic\nâ€‹\trandom\nç¡¬ä»¶(Cryptoä¾§ä¿¡é“)\nâ€‹\tRead&amp;Slove\nReversere1æ‹–è¿›idaè¿›å…¥ä¸»ç¨‹åºï¼š\nè¿›å…¥åŠ å¯†å‡½æ•°çœ‹ä¸€çœ‹ï¼Œå—¯ï¼Œä¸€çœ¼xxteaåŠ å¯†\n\næ‹¿åˆ°å¯†æ–‡ï¼š\n473bbd10f9e05561c5ebf76a5f43238d0516091aef403dd4676ab1b4a978356b\n\nè·å–å¯†é’¥ï¼š\n34120000452300006745000089670000\n\nè„šæœ¬è§£å¯†ï¼š\nimport xxtea\n\ns &#x3D; 0x473bbd10f9e05561c5ebf76a5f43238d0516091aef403dd4676ab1b4a978356b.to_bytes(32, &#39;big&#39;)\nkey &#x3D; 0x34120000452300006745000089670000.to_bytes(16, &#39;big&#39;)\nflag &#x3D; xxtea.decrypt(s, key, padding&#x3D;False)\nprint(flag)\n\n\n\n\n\n\n\n\n\n\n7f943921724d63dc0ac9c6febf99fa88\nCryptoeasyRSAå·²çŸ¥:\n\nè§£æ–¹ç¨‹:\na * seed + b &#x3D; s1 (mod p)\n\na * s1 + b &#x3D; s2 (mod p)\n\na * s2 + b &#x3D; s3 (mod p)\n\nè§£å¾—seed=14337636555117933152506165016723944787939761429733562849369091223517166614830298165864272285381681301117\næœ€åç›´æ¥long_to_bytes(seed)\n\n\n\n\n\n\n\n\n\ne4syRsa1snotdifficult5996642D0A7415EF\nMsicrandomå…ˆæ ¹æ®å›¾ç‰‡çš„åƒç´ é€šé“å€¼å°†åŸæœ¬çš„r3æ•°ç»„è¿˜åŸï¼Œå†æ¨¡æ‹ŸåŸæœ¬æ‰“ä¹±çš„é¡ºåºï¼Œå°†å…¶è¿˜åŸåå¾—åˆ°flag\nexp:\nimport random\nfrom PIL import Image\n\ndef pbl(bits):\n  num &#x3D; random.getrandbits(bits)\n  bins &#x3D; []\n  while num:\n    bins.append(num &amp; 1)\n    num &gt;&gt;&#x3D; 1\n  while len(bins) !&#x3D; bits:\n    bins.append(0)\n  return bins\n \nr3 &#x3D; []\nxx &#x3D; Image.open(&#39;xx.png&#39;)\ncat &#x3D; Image.open(&#39;1.png&#39;)\nfor i in range(198):\n  for j in range(141):\n    r3.append(xx.getpixel((i, j))[2] ^ cat.getpixel((i, j))[2])\n\norder &#x3D; []\nfor i in range(27918):\n  order.append(i)\n\nrandom.seed(793211)\npbl(27918)\npbl(27918)\nrandom.getrandbits((27918 - 28) * 8)\nrandom.shuffle(order)\n\nflag &#x3D; []\nfor i in range(28):\n  for j in range(len(order)):\n    if order[j] &#x3D;&#x3D; i:\n      flag.append(r3[j])\n\nfor i in flag:\n  print(chr(i), end&#x3D;&#39;&#39;)\n\n\n\n\n\n\n\n\n\n\nflag{lovely_cat_with_random}\nç¡¬ä»¶(Cryptoä¾§ä¿¡é“)Read&amp;Slove\nå°†æ³¢å½¢ç¿»è¯‘ä¸ºäºŒè¿›åˆ¶å³1010 1101 0010 1100\nå†æ ¹æ®å…¬å‘Šè¯´æ¢æˆhex:ad2c\n","slug":"20220801-hws-qualifier","date":"2022-08-01T03:00:00.000Z","categories_index":"Write Up","tags_index":"ctf,wp,reverse","author_index":"y9nhjy"}]