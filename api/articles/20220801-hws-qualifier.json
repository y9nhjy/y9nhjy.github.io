{"title":"2022-HWS夏令营预选赛","uid":"ebb392945466e3b28411a4ab0abfa6f9","slug":"20220801-hws-qualifier","date":"2022-08-01T03:00:00.000Z","updated":"2023-08-16T08:25:20.550Z","comments":true,"path":"api/articles/20220801-hws-qualifier.json","keywords":null,"cover":[],"content":"<p><strong>2022-HWS夏令营预选赛</strong></p>\n<p>比赛：HWS计划第五期-2022硬件安全在线夏令营线上预选赛</p>\n<p>时间：2022-07-29 09:00:00~2022-08-01 21:00:00</p>\n<p><a href=\"#Reverse\">Reverse</a></p>\n<p>​\t<a href=\"#re1\">re1</a></p>\n<p><a href=\"#Crypto\">Crypto</a></p>\n<p>​\t<a href=\"#easyRSA\">easyRSA</a></p>\n<p><a href=\"#Msic\">Msic</a></p>\n<p>​\t<a href=\"#random\">random</a></p>\n<p><a href=\"#%E7%A1%AC%E4%BB%B6(Crypto%E4%BE%A7%E4%BF%A1%E9%81%93)\">硬件(Crypto侧信道)</a></p>\n<p>​\t<a href=\"#Read&Slove\">Read&amp;Slove</a></p>\n<h1 id=\"Reverse\"><a href=\"#Reverse\" class=\"headerlink\" title=\"Reverse\"></a>Reverse</h1><h2 id=\"re1\"><a href=\"#re1\" class=\"headerlink\" title=\"re1\"></a>re1</h2><p>拖进ida进入主程序：</p>\n<p>进入加密函数看一看，嗯，一眼xxtea加密</p>\n<p><img src=\"20220801-hws-qualifier/re1.jpg\" alt=\"re1\"></p>\n<p>拿到密文：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">473bbd10f9e05561c5ebf76a5f43238d0516091aef403dd4676ab1b4a978356b</code></pre>\n\n<p>获取密钥：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">34120000452300006745000089670000</code></pre>\n\n<p>脚本解密：</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">import xxtea\n\ns &#x3D; 0x473bbd10f9e05561c5ebf76a5f43238d0516091aef403dd4676ab1b4a978356b.to_bytes(32, &#39;big&#39;)\nkey &#x3D; 0x34120000452300006745000089670000.to_bytes(16, &#39;big&#39;)\nflag &#x3D; xxtea.decrypt(s, key, padding&#x3D;False)\nprint(flag)</code></pre>\n\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>7f943921724d63dc0ac9c6febf99fa88</p></blockquote>\n<h1 id=\"Crypto\"><a href=\"#Crypto\" class=\"headerlink\" title=\"Crypto\"></a>Crypto</h1><h2 id=\"easyRSA\"><a href=\"#easyRSA\" class=\"headerlink\" title=\"easyRSA\"></a>easyRSA</h2><p>已知:</p>\n<p><img src=\"20220801-hws-qualifier/esayRSA.jpg\" alt=\"esayRSA\"></p>\n<p>解方程:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a * seed + b &#x3D; s1 (mod p)\n\na * s1 + b &#x3D; s2 (mod p)\n\na * s2 + b &#x3D; s3 (mod p)</code></pre>\n\n<p>解得<code>seed=14337636555117933152506165016723944787939761429733562849369091223517166614830298165864272285381681301117</code></p>\n<p>最后直接long_to_bytes(seed)</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>e4syRsa1snotdifficult5996642D0A7415EF</p></blockquote>\n<h1 id=\"Msic\"><a href=\"#Msic\" class=\"headerlink\" title=\"Msic\"></a>Msic</h1><h2 id=\"random\"><a href=\"#random\" class=\"headerlink\" title=\"random\"></a>random</h2><p>先根据图片的像素通道值将原本的r3数组还原，再模拟原本打乱的顺序，将其还原后得到flag</p>\n<p>exp:</p>\n<pre class=\"line-numbers language-c\" data-language=\"c\"><code class=\"language-c\">import random\nfrom PIL import Image\n\ndef pbl(bits):\n  num &#x3D; random.getrandbits(bits)\n  bins &#x3D; []\n  while num:\n    bins.append(num &amp; 1)\n    num &gt;&gt;&#x3D; 1\n  while len(bins) !&#x3D; bits:\n    bins.append(0)\n  return bins\n \nr3 &#x3D; []\nxx &#x3D; Image.open(&#39;xx.png&#39;)\ncat &#x3D; Image.open(&#39;1.png&#39;)\nfor i in range(198):\n  for j in range(141):\n    r3.append(xx.getpixel((i, j))[2] ^ cat.getpixel((i, j))[2])\n\norder &#x3D; []\nfor i in range(27918):\n  order.append(i)\n\nrandom.seed(793211)\npbl(27918)\npbl(27918)\nrandom.getrandbits((27918 - 28) * 8)\nrandom.shuffle(order)\n\nflag &#x3D; []\nfor i in range(28):\n  for j in range(len(order)):\n    if order[j] &#x3D;&#x3D; i:\n      flag.append(r3[j])\n\nfor i in flag:\n  print(chr(i), end&#x3D;&#39;&#39;)</code></pre>\n\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>flag{lovely_cat_with_random}</p></blockquote>\n<h1 id=\"硬件-Crypto侧信道\"><a href=\"#硬件-Crypto侧信道\" class=\"headerlink\" title=\"硬件(Crypto侧信道)\"></a>硬件(Crypto侧信道)</h1><h2 id=\"Read-Slove\"><a href=\"#Read-Slove\" class=\"headerlink\" title=\"Read&amp;Slove\"></a>Read&amp;Slove</h2><p><img src=\"20220801-hws-qualifier/Read&Solve.jpg\" alt=\"Read&amp;Solve\"></p>\n<p>将波形翻译为二进制即1010 1101 0010 1100</p>\n<p>再根据公告说换成hex:ad2c</p>\n","feature":false,"text":"2022-HWS夏令营预选赛 比赛：HWS计划第五期-2022硬件安全在线夏令营线上预选赛 时间：2022-07-29 09:00:00~2022-08-01 ...","link":"","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"Write Up","slug":"Write-Up","count":3,"path":"api/categories/Write-Up.json"}],"tags":[{"name":"ctf","slug":"ctf","count":3,"path":"api/tags/ctf.json"},{"name":"wp","slug":"wp","count":3,"path":"api/tags/wp.json"},{"name":"reverse","slug":"reverse","count":4,"path":"api/tags/reverse.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Reverse\"><span class=\"toc-text\">Reverse</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#re1\"><span class=\"toc-text\">re1</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Crypto\"><span class=\"toc-text\">Crypto</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#easyRSA\"><span class=\"toc-text\">easyRSA</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Msic\"><span class=\"toc-text\">Msic</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#random\"><span class=\"toc-text\">random</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%A1%AC%E4%BB%B6-Crypto%E4%BE%A7%E4%BF%A1%E9%81%93\"><span class=\"toc-text\">硬件(Crypto侧信道)</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Read-Slove\"><span class=\"toc-text\">Read&amp;Slove</span></a></li></ol></li></ol>","author":{"name":"y9nhjy","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/73747088?v=4","link":"https://y9nhjy.github.io","description":"手握日月摘星辰","socials":{"github":"https://github.com/y9nhjy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_51280668","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"2022-HWS&强网杯-复现","uid":"5bb046c422c129abba05bb14d8709ec6","slug":"20220803-hws-qwb-recurrent","date":"2022-08-03T03:00:00.000Z","updated":"2023-08-16T10:28:21.257Z","comments":true,"path":"api/articles/20220803-hws-qwb-recurrent.json","keywords":null,"cover":[],"text":"2022-HWS&amp;强网杯-复现 HWS ​ re2 ​ re3 强网杯 ​ GameMaster ​ easyre HWSre2拿到源文件re2.exe...","link":"","photos":[],"count_time":{"symbolsCount":"23k","symbolsTime":"21 mins."},"categories":[{"name":"Write Up","slug":"Write-Up","count":3,"path":"api/categories/Write-Up.json"}],"tags":[{"name":"ctf","slug":"ctf","count":3,"path":"api/tags/ctf.json"},{"name":"wp","slug":"wp","count":3,"path":"api/tags/wp.json"},{"name":"reverse","slug":"reverse","count":4,"path":"api/tags/reverse.json"}],"author":{"name":"y9nhjy","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/73747088?v=4","link":"https://y9nhjy.github.io","description":"手握日月摘星辰","socials":{"github":"https://github.com/y9nhjy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_51280668","juejin":"","customs":{}}},"feature":true},"next_post":{}}